%
% File created:      20220404 S Knox
% File modified:     20240603 Zoran

Site_name = 'Delta Site Marsh'
SiteID = 'DSM'

Difference_GMT_to_local_time = 8    % hours (GMT - PST)
Timezone = 8                        % hours
% if Timezone == 0 then the database is in UTC/GMT 
% if Timezone == Difference_GMT_to_local_time then the database is in ST
% having the offset positive when it should be negative (after all PST = GMT - 8)
% is a legacy issue that (hopefully) will be sorted out at some point in the future.

%---------------------------------------
% Global variables (instrument-specific)
%--------------------------------------- 
% The instrument traces will all need to have the same 
% instrumentType field 'LI7200', 'LI7700'...
% and come from the same software (EddyPro)
globalVars.Instrument.IRGA.Enable                       = 1             % Required variable 0/1
globalVars.Instrument.IRGA.instrument				            = 'LI-7200'
globalVars.Instrument.IRGA.instrumentSN                 = '72H-1029'
globalVars.Instrument.IRGA.inputFileName_dates          = [datenum(2021,9,4) datenum(2999,1,1)]

globalVars.Instrument.LI7700.Enable                     = 1	            % Required variable 0/1
globalVars.Instrument.LI7700.instrumentSN               = 'TG1-0707'
globalVars.Instrument.LI7700.inputFileName_dates        = [datenum(2021,9,4) datenum(2999,1,1)]

globalVars.Instrument.Anemometer.Enable                 = 1             % Required variable 0/1
globalVars.Instrument.Anemometer.instrument             = 'CSAT3'
globalVars.Instrument.Anemometer.instrumentSN           = '1341-1'
globalVars.Instrument.Anemometer.inputFileName_dates    = [datenum(2021,9,4) datenum(2999,1,1)]

globalVars.Instrument.EC.Enable                         = 1		        % Required variable 0/1
globalVars.Instrument.EC.instrumentSN                   = [globalVars.Instrument.Anemometer.instrumentSN ' & ' globalVars.Instrument.IRGA.instrumentSN ' & ' globalVars.Instrument.LI7700.instrumentSN]
globalVars.Instrument.EC.inputFileName_dates            = [datenum(2021,9,4) datenum(2999,1,1)]

globalVars.Instrument.otherTraces.inputFileName_dates   = [datenum(2021,9,4) datenum(2999,1,1)]

%------------------------------------------------------------------------------------
% Globar variable specification (trace-specific)
%------------------------------------------------------------------------------------
%--> Radiation sensor information
globalVars.Trace.SW_IN_1_1_1.inputFileName 			        = {'MET_CNR4_SWi_Avg'} 
globalVars.Trace.SW_IN_1_1_1.inputFileName_dates 	      = [datenum(2021,1,1) datenum(2999,1,1)] 
globalVars.Trace.SW_IN_1_1_1.instrument 			          = 'CNR4'
globalVars.Trace.SW_IN_1_1_1.instrumentSN 			        = '171561'
globalVars.Trace.SW_IN_1_1_1.Evaluate                   = 'SW_IN_1_1_1 = shiftMyData(clean_tv,SW_IN_1_1_1);'

globalVars.Trace.SW_OUT_1_1_1.inputFileName 		        = {'MET_CNR4_SWo_Avg'} 
globalVars.Trace.SW_OUT_1_1_1.inputFileName_dates 	    = globalVars.Trace.SW_IN_1_1_1.inputFileName_dates
globalVars.Trace.SW_OUT_1_1_1.instrument 			          = globalVars.Trace.SW_IN_1_1_1.instrument
globalVars.Trace.SW_OUT_1_1_1.instrumentSN 			        = globalVars.Trace.SW_IN_1_1_1.instrument
globalVars.Trace.SW_OUT_1_1_1.Evaluate                  = 'SW_OUT_1_1_1 = shiftMyData(clean_tv,SW_OUT_1_1_1);'

globalVars.Trace.LW_IN_1_1_1.inputFileName 			        = {'MET_CNR4_LWi_Avg'} 
globalVars.Trace.LW_IN_1_1_1.inputFileName_dates 	      = globalVars.Trace.SW_IN_1_1_1.inputFileName_dates
globalVars.Trace.LW_IN_1_1_1.instrument 			          = globalVars.Trace.SW_IN_1_1_1.instrument
globalVars.Trace.LW_IN_1_1_1.instrumentSN 			        = globalVars.Trace.SW_IN_1_1_1.instrument
globalVars.Trace.LW_IN_1_1_1.Evaluate                   = 'LW_IN_1_1_1 = shiftMyData(clean_tv,LW_IN_1_1_1); '

globalVars.Trace.LW_OUT_1_1_1.inputFileName 		        = {'MET_CNR4_LWo_Avg'} 
globalVars.Trace.LW_OUT_1_1_1.inputFileName_dates 	    = globalVars.Trace.SW_IN_1_1_1.inputFileName_dates
globalVars.Trace.LW_OUT_1_1_1.instrument 			          = globalVars.Trace.SW_IN_1_1_1.instrument
globalVars.Trace.LW_OUT_1_1_1.instrumentSN 			        = globalVars.Trace.SW_IN_1_1_1.instrument
globalVars.Trace.LW_OUT_1_1_1.Evaluate                  = 'LW_OUT_1_1_1 = shiftMyData(clean_tv,LW_OUT_1_1_1);'

globalVars.Trace.NETRAD_1_1_1.inputFileName 		        = {'MET_CNR4_Net_Avg'} 
globalVars.Trace.NETRAD_1_1_1.inputFileName_dates 	    = globalVars.Trace.SW_IN_1_1_1.inputFileName_dates
globalVars.Trace.NETRAD_1_1_1.instrument 			          = globalVars.Trace.SW_IN_1_1_1.instrument
globalVars.Trace.NETRAD_1_1_1.instrumentSN 			        = globalVars.Trace.SW_IN_1_1_1.instrument
globalVars.Trace.NETRAD_1_1_1.Evaluate                  = 'NETRAD_1_1_1 = shiftMyData(clean_tv,NETRAD_1_1_1);'

globalVars.Trace.ALB_1_1_1.inputFileName 			          = {'MET_CNR4_Alb_Avg'} 
globalVars.Trace.ALB_1_1_1.inputFileName_dates 		      = globalVars.Trace.SW_IN_1_1_1.inputFileName_dates
globalVars.Trace.ALB_1_1_1.instrument 				          = globalVars.Trace.SW_IN_1_1_1.instrument
globalVars.Trace.ALB_1_1_1.instrumentSN 			          = globalVars.Trace.SW_IN_1_1_1.instrument
globalVars.Trace.ALB_1_1_1.loggedCalibration 		        = [1 0 datenum(2021,1,1) datenum(2999,1,1)] 
globalVars.Trace.ALB_1_1_1.currentCalibration 		      = [100 0 datenum(2021,1,1) datenum(2999,1,1)] % Convert decimal to %
globalVars.Trace.ALB_1_1_1.Evaluate                     = 'ALB_1_1_1 = shiftMyData(clean_tv,ALB_1_1_1);'

globalVars.Trace.PPFD_IN_1_1_1.inputFileName            = {'MET_PARin_Avg'}
globalVars.Trace.PPFD_IN_1_1_1.inputFileName_dates      = [datenum(2021,1,1) datenum(2999,1,1)] 
globalVars.Trace.PPFD_IN_1_1_1.instrument               = 'Confirm if PQS1-L or Li-190' 
globalVars.Trace.PPFD_IN_1_1_1.instrumentSN             = '202108'
globalVars.Trace.PPFD_IN_1_1_1.Evaluate                 = 'PPFD_IN_1_1_1 = shiftMyData(clean_tv,PPFD_IN_1_1_1);'

globalVars.Trace.PPFD_OUT_1_1_1.inputFileName           = {'MET_PARout_Avg'}
globalVars.Trace.PPFD_OUT_1_1_1.inputFileName_dates     = [datenum(2021,1,1) datenum(2999,1,1)] 
globalVars.Trace.PPFD_OUT_1_1_1.instrument              = 'PQS1' 
globalVars.Trace.PPFD_OUT_1_1_1.instrumentSN            = 'PY2937'
globalVars.Trace.PPFD_OUT_1_1_1.Evaluate                = 'PPFD_OUT_1_1_1 = shiftMyData(clean_tv,PPFD_OUT_1_1_1);'

%--> Calibrations
globalVars.Trace.T_SONIC.loggedCalibration              = [1       0 datenum(2021,1,1) datenum(2999,1,1)] % Conversion K to C
globalVars.Trace.T_SONIC.currentCalibration             = [1 -273.15 datenum(2021,1,1) datenum(2999,1,1)]    
globalVars.Trace.air_p_mean.loggedCalibration           = [1       0 datenum(2021,1,1) datenum(2999,1,1)]
globalVars.Trace.air_p_mean.currentCalibration          = [1/1000  0 datenum(2021,1,1) datenum(2999,1,1)]
globalVars.Trace.WTD_1_1_1.loggedCalibration            = [1       0    datenum(2021,1,1) datenum(2999,1,1)]
globalVars.Trace.WTD_1_1_1.currentCalibration           = [1.03 -1.864  datenum(2021,1,1) datenum(2999,1,1)] % Confirm offset to get WTD relative to soil surface! 

%--> ECCC station for OHM
globalVars.other.ECCC_station = 925


% Cleaning and Service Flags

% Example of a new feature - cleaning based on time periods
%[Trace]
%	variableName = 'flag_Kill_TimePeriod'
%	title = 'Testing'
%	inputFileName = {'clean_tv'}
%	inputFileName_dates = []
%	measurementType = 'Flux'
%	units = ''
%	instrument = ''
%	instrumentSN = []
%       loggedCalibration = []
%        currentCalibration = []
%	comments = 'Remove data before May 1, 2023 and after Jun 1, 2023 from the dependent traces'
%   % minMax needs to be entered as Matlab datenum like this: 
%	% minMax = [datenum(2023,5,1) datenum(2023,6,1)]
%	minMax = [-Inf, Inf]
%	zeroPt = [-9999]
%
%	plotBottomLeft = ''
%	dependent = 'tag_All'
%
%[End]


% Load time vector clean_tv
[Trace]
	variableName = 'clean_tv'
	title = 'Testing'
	inputFileName = {'clean_tv'}
	inputFileName_dates = []
	measurementType = 'Flux'
	units = ''
	instrument = ''
	instrumentSN = []
       loggedCalibration = []
        currentCalibration = []
	comments = 'Load time vector so that it becomes available for Evaluate calculations'
	minMax = [-Inf, Inf]
	zeroPt = [-9999]
	dependent = ''
[End]


[Trace]
                  variableName = 'flag_B4INSTAL'
                         title = 'Flag: Data before installing MET sensors'
                 inputFileName = {'clean_tv'}
           inputFileName_dates = []
               measurementType = 'Flags'
                         units = ''
                    instrument = ''
                  instrumentSN = ''
             loggedCalibration = []
            currentCalibration = []
                      comments = ''
                        minMax = []
                        zeroPt = [-9999]
                     dependent = 'TS_1_1_1,TS_2_1_1, TS_1_2_1, TS_2_2_1, TS_1_3_1, TS_2_3_1, TS_1_4_1, TS_2_4_1, G_1_1_1, G_2_1_1, G_3_1_1, SW_IN_1_1_1, SW_OUT_1_1_1, LW_IN_1_1_1, LW_OUT_1_1_1, ALB_1_1_1, PPFD_IN_1_1_1, PPFD_OUT_1_1_1, PPFD_IN_2_1_1, PPFD_DIF_1_1_1, PRI_1_1_1, NDVI_1_1_1, WS_1_1_1, WD_1_1_1, TA_1_1_1, TA_1_2_1, RH_1_1_1, RH_1_2_1, PA_1_1_1, P_1_1_1'

[End]

[Trace]
                  variableName = 'flag_PRI_1_1_1'
                         title = 'Flag: Bad data for PRI sensor'
                 inputFileName = {'flag_PRI_1_1_1'}
           inputFileName_dates = []
               measurementType = 'Flags'
                         units = ''
                    instrument = ''
                  instrumentSN = ''
             loggedCalibration = []
            currentCalibration = []
                      comments = ''
                        minMax = [0,1]
                        zeroPt = [-9999]

                     dependent = 'PRI_1_1_1'

[End]

[Trace]
                  variableName = 'flag_NDVI_1_1_1'
                         title = 'Flag: Bad data for PRI sensor'
                 inputFileName = {'flag_NDVI_1_1_1'}
           inputFileName_dates = []
               measurementType = 'Flags'
                         units = ''
                    instrument = ''
                  instrumentSN = ''
             loggedCalibration = []
            currentCalibration = []
                      comments = ''
                        minMax = [0,1]
                        zeroPt = [-9999]
                     dependent = 'NDVI_1_1_1'

[End]

[Trace]
                  variableName = 'flag_pH_1_1_1'
                         title = 'Flag: Bad data for pH sensor'
                 inputFileName = {'flag_pH_1_1_1'}
           inputFileName_dates = []
               measurementType = 'Flags'
                         units = ''
                    instrument = ''
                  instrumentSN = ''
             loggedCalibration = []
            currentCalibration = []
                      comments = ''
                        minMax = [0,1]
                        zeroPt = [-9999]
                     dependent = 'pH_1_1_1'

[End]

[Trace]
                  variableName = 'flag_DO_1_1_1'
                         title = 'Flag: Bad data for DO sensor'
                 inputFileName = {'flag_DO_1_1_1'}
           inputFileName_dates = []
               measurementType = 'Flags'
                         units = ''
                    instrument = ''
                  instrumentSN = ''
             loggedCalibration = []
            currentCalibration = []
                      comments = ''
                        minMax = [0,1]
                        zeroPt = [-9999]
                     dependent = 'DO_1_1_1, DOperc_1_1_1'
[End]

[Trace]
                  variableName = 'flag_COND_1_1_1'
                         title = 'Flag: Bad data for water conductivity sensor'
                 inputFileName = {'flag_COND_1_1_1'}
           inputFileName_dates = []
               measurementType = 'Flags'
                         units = ''
                    instrument = ''
                  instrumentSN = ''
             loggedCalibration = []
            currentCalibration = []
                      comments = ''
                        minMax = [0,1]
                        zeroPt = [-9999]
                     dependent = 'COND_WATER_1_1_1'
[End]

[Trace]
                  variableName = 'flag_ORP_1_1_1'
                         title = 'Flag: Bad data for ORP sensor'
                 inputFileName = {'flag_ORP_1_1_1'}
           inputFileName_dates = []
               measurementType = 'Flags'
                         units = ''
                    instrument = ''
                  instrumentSN = ''
             loggedCalibration = []
            currentCalibration = []
                      comments = ''
                        minMax = [0,1]
                        zeroPt = [-9999]
                     dependent = 'ORP_1_1_1'
[End]

[Trace]
                  variableName = 'flag_TW_1_1_1'
                         title = 'Flag: Bad data for WTD sensor'
                 inputFileName = {'flag_TW_1_1_1'}
           inputFileName_dates = []
               measurementType = 'Flags'
                         units = ''
                    instrument = ''
                  instrumentSN = ''
             loggedCalibration = []
            currentCalibration = []
                      comments = ''
                        minMax = [0,1]
                        zeroPt = [-9999]
                     dependent = 'TW_1_1_1'
[End]

[Trace]
                  variableName = 'flag_WTD_1_1_1'
                         title = 'Flag: Bad data for WTD sensor'
                 inputFileName = {'flag_WTD_1_1_1'}
           inputFileName_dates = []
               measurementType = 'Flags'
                         units = ''
                    instrument = ''
                  instrumentSN = ''
             loggedCalibration = []
            currentCalibration = []
                      comments = ''
                        minMax = [0,1]
                        zeroPt = [-9999]
                     dependent = 'WTD_1_1_1'
[End]

% Air temperature and RH
[Trace]
                  variableName = 'TA_1_1_1'
                         title = 'Air temperature at 2m (HMP)'
                 inputFileName = {'MET_HMP_T_2m_Avg'}
           inputFileName_dates = []
               measurementType = 'met'
                         units = '°C'
                    instrument = 'HMP155A'
                  instrumentSN = 'N4520546'
             loggedCalibration = []
            currentCalibration = []
                      comments = ''
                      Evaluate = 'TA_1_1_1=shiftMyData(clean_tv,TA_1_1_1);
                                  wlen=24;thres=4;TA_1_1_1 = run_std_dev(TA_1_1_1,clean_tv,wlen,thres);'
                        minMax = [-20,50]
                        zeroPt = [-9999]
                     dependent = ''
[End]

[Trace]
                  variableName = 'TA_1_2_1'
                         title = 'Air temperature at 350cm (HMP)'
                 inputFileName = {'MET_HMP_T_350cm_Avg'}
           inputFileName_dates = []
               measurementType = 'met'
                         units = '°C'
                    instrument = 'HMP60'
                  instrumentSN = 'S3530641'
             loggedCalibration = []
            currentCalibration = []
                      comments = ''
                      Evaluate = 'TA_1_2_1 = shiftMyData(clean_tv,TA_1_2_1); % Time Shift Correction
                                  TA_1_2_1 = run_std_dev(TA_1_2_1,clean_tv,wlen,thres);'
                        minMax = [-20,50]
                        zeroPt = [-9999]
                     dependent = ''
[End]

[Trace]
                  variableName = 'RH_1_1_1'
                         title = 'Relative humidity at 2m (HMP)'
                 inputFileName = {'MET_HMP_RH_2m_Avg'}
           inputFileName_dates = []
               measurementType = 'met'
                         units = '%'
                    instrument = 'HMP155A'
                  instrumentSN = 'N4520546'
             loggedCalibration = []
            currentCalibration = []
                      comments = ''
                      Evaluate = 'RH_1_1_1 = shiftMyData(clean_tv,RH_1_1_1); % Time Shift Correction
                                  RH_1_1_1 = run_std_dev(RH_1_1_1,clean_tv,wlen,thres);'
                        minMax = [0,110]
                clamped_minMax = [0,100]
                        zeroPt = [-9999]
                     dependent = ''
[End]

[Trace]
                  variableName = 'RH_1_2_1'
                         title = 'Relative humidity at 350cm (HMP)'
                 inputFileName = {'MET_HMP_RH_350cm_Avg'}
           inputFileName_dates = []
               measurementType = 'met'
                         units = '%'
                    instrument = 'HMP60'
                  instrumentSN = 'S3530641'
             loggedCalibration = []
            currentCalibration = []
                      comments = ''
                      Evaluate = 'RH_1_2_1 = shiftMyData(clean_tv,RH_1_2_1); % Time Shift Correction
                                  RH_1_2_1 = run_std_dev(RH_1_2_1,clean_tv,wlen,thres);'
                        minMax = [0,110]
                clamped_minMax = [0,100]
                        zeroPt = [-9999]
                     dependent = ''
[End]

% Temperature diagnostics
[Trace]
                  variableName = 'SysPTAM25T_1_1_1'
                         title = 'panel temperature of AM25T'
                 inputFileName = {'SYS_PanelT_AM25T_Avg'}
           inputFileName_dates = []
               measurementType = 'met'
                         units = '°C'
                    instrument = 'Thermistor'
                  instrumentSN = '10375'
             loggedCalibration = []
            currentCalibration = []
                      comments = ''
                        minMax = [-30,60]
                        zeroPt = [-9999]
                     dependent = ''
[End]

% Soil temperature, heat flux, and moisture
[Trace]
                  variableName = 'TS_1_1_1'
                         title = 'soil temperature at 5cm depth (east)'
                 inputFileName = {'MET_SoilT_P1_5cm_Avg'}
           inputFileName_dates = []
               measurementType = 'met'
                         units = '°C'
                    instrument = 'Type T thermocouple'
                  instrumentSN = ''
             loggedCalibration = []
            currentCalibration = []
                      comments = ''
                      Evaluate = 'TS_1_1_1 = shiftMyData(clean_tv,TS_1_1_1); % Time Shift Correction
                                  TS_1_1_1 = run_std_dev(TS_1_1_1,clean_tv,wlen,thres);'
                        minMax = [-20,60]
                        zeroPt = [-9999]
                     dependent = ''
[End]

[Trace]
                  variableName = 'TS_1_2_1'
                         title = 'soil temperature at 10cm depth (east)'
                 inputFileName = {'MET_SoilT_P1_10cm_Avg'}
           inputFileName_dates = []
               measurementType = 'met'
                         units = '°C'
                    instrument = 'Type T thermocouple'
                  instrumentSN = ''
             loggedCalibration = []
            currentCalibration = []
                      comments = ''
                      Evaluate = 'TS_1_2_1 = shiftMyData(clean_tv,TS_1_2_1); % Time Shift Correction
                                  TS_1_2_1 = run_std_dev(TS_1_2_1,clean_tv,wlen,thres);'
                        minMax = [-20,60]
                        zeroPt = [-9999]
                     dependent = ''
[End]

[Trace]
                  variableName = 'TS_1_3_1'
                         title = 'soil temperature at 20cm depth (east)'
                 inputFileName = {'MET_SoilT_P1_20cm_Avg'}
           inputFileName_dates = []
               measurementType = 'met'
                         units = '°C'
                    instrument = 'Type T thermocouple'
                  instrumentSN = ''
             loggedCalibration = []
            currentCalibration = []
                      comments = ''
                      Evaluate = 'TS_1_3_1 = shiftMyData(clean_tv,TS_1_3_1); % Time Shift Correction
                                  TS_1_3_1 = run_std_dev(TS_1_3_1,clean_tv,wlen,thres);'
                        minMax = [-20,60]
                        zeroPt = [-9999]
                     dependent = ''
[End]

[Trace]
                  variableName = 'TS_1_4_1'
                         title = 'soil temperature at 50cm depth (east)'
                 inputFileName = {'MET_SoilT_P1_50cm_Avg'}
           inputFileName_dates = []
               measurementType = 'met'
                         units = '°C'
                    instrument = 'Type T thermocouple'
                  instrumentSN = ''
             loggedCalibration = []
            currentCalibration = []
                      comments = ''
                      Evaluate = 'TS_1_4_1 = shiftMyData(clean_tv,TS_1_4_1); % Time Shift Correction
                                  TS_1_4_1 = run_std_dev(TS_1_4_1,clean_tv,wlen,thres);'
                        minMax = [-20,60]
                        zeroPt = [-9999]
                     dependent = ''
[End]

[Trace]
                  variableName = 'TS_2_1_1'
                         title = 'soil temperature at 5cm depth (west)'
                 inputFileName = {'MET_SoilT_P2_5cm_Avg'}
           inputFileName_dates = []
               measurementType = 'met'
                         units = '°C'
                    instrument = 'Type T thermocouple'
                  instrumentSN = ''
             loggedCalibration = []
            currentCalibration = []
                      comments = ''
                      Evaluate = 'TS_2_1_1 = shiftMyData(clean_tv,TS_2_1_1); % Time Shift Correction
                                  TS_2_1_1 = run_std_dev(TS_2_1_1,clean_tv,wlen,thres);'
                        minMax = [-20,60]
                        zeroPt = [-9999]
                     dependent = ''
[End]

[Trace]
                  variableName = 'TS_2_2_1'
                         title = 'soil temperature at 10cm depth (west)'
                 inputFileName = {'MET_SoilT_P2_10cm_Avg'}
           inputFileName_dates = []
               measurementType = 'met'
                         units = '°C'
                    instrument = 'Type T thermocouple'
                  instrumentSN = ''
             loggedCalibration = []
            currentCalibration = []
                      comments = ''
                   	  Evaluate = 'TS_2_2_1 = shiftMyData(clean_tv,TS_2_2_1); % Time Shift Correction
				                          TS_2_2_1 = run_std_dev(TS_2_2_1,clean_tv,wlen,thres);'
                        minMax = [-20,60]
                        zeroPt = [-9999]
                     dependent = ''
[End]

[Trace]
                  variableName = 'TS_2_3_1'
                         title = 'soil temperature at 20cm depth (west)'
                 inputFileName = {'MET_SoilT_P2_20cm_Avg'}
           inputFileName_dates = []
               measurementType = 'met'
                         units = '°C'
                    instrument = 'Type T thermocouple'
                  instrumentSN = ''
             loggedCalibration = []
            currentCalibration = []
                      comments = ''
                      Evaluate = 'TS_2_3_1 = shiftMyData(clean_tv,TS_2_3_1); % Time Shift Correction
                                  TS_2_3_1 = run_std_dev(TS_2_3_1,clean_tv,wlen,thres);'
                        minMax = [-20,60]
                        zeroPt = [-9999]
                     dependent = ''
[End]


[Trace]
                  variableName = 'TS_2_4_1'
                         title = 'soil temperature at 50cm depth (west)'
                 inputFileName = {'MET_SoilT_P2_50cm_Avg'}
           inputFileName_dates = []
               measurementType = 'met'
                         units = '°C'
                    instrument = 'Type T thermocouple'
                  instrumentSN = ''
             loggedCalibration = []
            currentCalibration = []
                      comments = ''
                      Evaluate = 'TS_2_4_1 = shiftMyData(clean_tv,TS_2_4_1); % Time Shift Correction
                                  TS_2_4_1 = run_std_dev(TS_2_4_1,clean_tv,wlen,thres);'
                        minMax = [-20,60]
                        zeroPt = [-9999]
                     dependent = ''
[End]

[Trace]
                  variableName = 'G_1_1_1'
                         title = 'soil heat flux at 5cm depth (east)'
                 inputFileName = {'MET_SHFP_1_Avg'}
           inputFileName_dates = []
               measurementType = 'met'
                         units = 'W m^-2'
                    instrument = 'Hukseflux HFP01-L'
                  instrumentSN = '18746'
             loggedCalibration = []
            currentCalibration = []
                      comments = ''
                      Evaluate = 'G_1_1_1 = shiftMyData(clean_tv,G_1_1_1); % Time Shift Correction
                                  G_1_1_1 = run_std_dev(G_1_1_1,clean_tv,wlen,thres);'
                        minMax = [-40,60]
                        zeroPt = [-9999]
	                 dependent = ''
[End]

[Trace]
                  variableName = 'G_2_1_1'
                         title = 'soil heat flux at 5cm depth (west)'
                 inputFileName = {'MET_SHFP_2_Avg'}
           inputFileName_dates = []
               measurementType = 'met'
                         units = 'W m^-2'
                    instrument = 'Hukseflux HFP01-L'
                  instrumentSN = '18747'
             loggedCalibration = []
            currentCalibration = []
                      comments = ''
                      Evaluate = 'G_2_1_1 = shiftMyData(clean_tv,G_2_1_1); % Time Shift Correction
                                  G_2_1_1 = run_std_dev(G_2_1_1,clean_tv,wlen,thres);'
                        minMax = [-40,60]
                        zeroPt = [-9999]
                     dependent = ''
[End]

[Trace]
                  variableName = 'G_3_1_1'
                         title = 'soil heat flux at 5cm depth (south)'
                 inputFileName = {'MET_SHFP_3_Avg'}
           inputFileName_dates = []
               measurementType = 'met'
                         units = 'W m^-2'
                    instrument = 'Hukseflux HFP01-L'
                  instrumentSN = '18748'
             loggedCalibration = []
            currentCalibration = []
                      comments = ''
                      Evaluate = 'G_3_1_1 = shiftMyData(clean_tv,G_3_1_1); % Time Shift Correction
                                  G_3_1_1 = run_std_dev(G_3_1_1,clean_tv,wlen,thres);'
                        minMax = [-40,60]
                        zeroPt = [-9999]
                     dependent = ''
[End]

% Radiation

[Trace]
                  variableName = 'RBM_SW_IN_1_1_1'
                         title = 'RBM incoming shortwave radiation by CNR4'
                 inputFileName = {'../../RBM/Met/MET_CNR4_SWi_Avg'} % ADD CLEAN PATH ONCE IN PROCESSING PIPELINE
           inputFileName_dates = []
               measurementType = 'met'
                         units = 'W/m^2'
                    instrument = 'CNR4'
                  instrumentSN = '212902'
             loggedCalibration = []
            currentCalibration = []
                      comments = ''
                        minMax = [-20,2000]
                        zeroPt = [-9999]
                     dependent = ''
[End]

[Trace]
                  variableName = 'PPFD_IN_2_1_1'
                         title = 'incoming PAR measured by BF5'
                 inputFileName = {'MET_BF5_Tpar_Avg'}
           inputFileName_dates = []
               measurementType = 'met'
                         units = '\mu mol/m^2/s'
                    instrument = 'BF5'
                  instrumentSN = '112/02'
             loggedCalibration = []
            currentCalibration = []
                      comments = ''
                      Evaluate = 'PPFD_IN_2_1_1 = shiftMyData(clean_tv,PPFD_IN_2_1_1); % Time Shift Correction'
                        minMax = [-40,3000]
                        zeroPt = [-9999]
                     dependent = ''
[End]

[Trace]
                  variableName = 'PPFD_DIF_1_1_1'
                         title = 'diffuse PAR measured by BF5'
                 inputFileName = {'MET_BF5_diffuse_Avg'}
           inputFileName_dates = []
               measurementType = 'met'
                         units = '\mu mol/m^2/s'
                    instrument = 'BF5'
                  instrumentSN = '112/02'
             loggedCalibration = []
            currentCalibration = []
                      comments = ''
                      Evaluate = 'PPFD_DIF_1_1_1 = shiftMyData(clean_tv,PPFD_DIF_1_1_1); % Time Shift Correction'
                        minMax = [-40,3000]
                        zeroPt = [-9999]
                     dependent = ''
[End]

[Trace]
                  variableName = 'RBM_LW_IN_1_1_1'
                         title = 'RBM incoming longwave radiation by CNR4'
                 inputFileName = {'../../RBM/Met/MET_CNR4_LWi_Avg'}
           inputFileName_dates = []
               measurementType = 'met'
                         units = 'W/m^2'
                    instrument = 'CNR4'
                  instrumentSN = '212902'
             loggedCalibration = []
            currentCalibration = []
                      comments = ''
                        minMax = [50,1000]
                        zeroPt = [-9999]
                     dependent = ''
[End]

[Trace]
                  variableName = 'RBM_LW_OUT_1_1_1'
                         title = 'RBM outgoing longwave radiation by CNR4'
                 inputFileName = {'../../RBM/Met/MET_CNR4_LWo_Avg'}
           inputFileName_dates = []
               measurementType = 'met'
                         units = 'W/m^2'
                    instrument = 'CNR4'
                  instrumentSN = '212902'
             loggedCalibration = []
            currentCalibration = []
                      comments = ''
                        minMax = [50,1000]
                        zeroPt = [-9999]
                     dependent = ''
[End]

[Trace]
                  variableName = 'RBM_NETRAD_1_1_1'
                         title = 'RBM net radiation by CNR4'
                 inputFileName = {'../../RBM/Met/MET_CNR4_Net_Avg'}
           inputFileName_dates = []
               measurementType = 'met'
                         units = 'W/m^2'
                    instrument = 'CNR4'
                  instrumentSN = '212902'
             loggedCalibration = []
            currentCalibration = []
                      comments = ''
                        minMax = [-100,1000]
                        zeroPt = [-9999]
                     dependent = ''
[End]

[Trace]
                  variableName = 'RBM_PPFD_IN_1_1_1'
                         title = 'RBM incoming PAR'
                 inputFileName = {'../../RBM/Met/MET_PARin_Avg'}
           inputFileName_dates = []
               measurementType = 'met'
                         units = '\mu mol/m^2/s'
                    instrument = 'PQS1-L' % Confirm if PQS1-L or Li-190 (2022.SEP.02, PQ1S-L confirmed, Tzu-Yi)
                  instrumentSN = '202109'
             loggedCalibration = []
            currentCalibration = []
                      comments = ''
                        minMax = [-40,3000]
                        zeroPt = [-9999]
                     dependent = ''
[End]

[Trace]
                  variableName = 'PRI_1_1_1'
                         title = 'Photochemical reflectance index'
                 inputFileName = {'MET_PRI_Avg'}
           inputFileName_dates = []
               measurementType = 'met'
                         units = 'nondimensional'
                    instrument = 'METER SRS-PRI'
                  instrumentSN = '1266903761, 1503103779' % hemi(incoming), field(reflected)
             loggedCalibration = []
            currentCalibration = []
                      comments = ''
                      Evaluate = 'PRI_1_1_1 = shiftMyData(clean_tv,PRI_1_1_1); % Time Shift Correction'
                        minMax = [-1.1,1.1]
                clamped_minMax = [-1,1]
                        zeroPt = [-9999]
                     dependent = ''
[End]


[Trace]
                  variableName = 'NDVI_1_1_1'
                         title = 'Normalized difference vegetation index'
                 inputFileName = {'MET_NDVI_Avg'}
           inputFileName_dates = []
               measurementType = 'met'
                         units = 'nondimensional'
                    instrument = 'METER SRS-NDVI'
                  instrumentSN = '1069, 1153' % hemi(incoming), field(reflected)
             loggedCalibration = []
            currentCalibration = []
                      comments = ''
                      Evaluate = 'NDVI_1_1_1 = shiftMyData(clean_tv,NDVI_1_1_1); % Time Shift Correction'
                        minMax = [-1.1,1.1]
                clamped_minMax = [-1,1]
                        zeroPt = [-9999]
                     dependent = ''
[End]

% Pressure

[Trace]
                  variableName = 'PA_1_1_1'
                         title = 'air pressure by CS106 installed in the logger box'
                 inputFileName = {'MET_Barom_Press_kPa_Avg'}
           inputFileName_dates = []
               measurementType = 'met'
                         units = 'kPa'
                    instrument = 'CS106'
                  instrumentSN = 'T1110868'
             loggedCalibration = []
            currentCalibration = []
                      comments = 'Should minMax be the same for both PA_1_1_1 and PA_ECCC?'
                      Evaluate = 'PA_1_1_1 = shiftMyData(clean_tv,PA_1_1_1);
                                  PA_1_1_1 = run_std_dev(PA_1_1_1,clean_tv,wlen,thres);'
                        minMax = [95,110]
                        zeroPt = [-9999]
                     dependent = ''
[End]


% Precipitation

[Trace]
                  variableName = 'P_1_1_1'
                         title = 'precipitation at 1.05m height'
                 inputFileName = {'MET_RainTips_Tot'}
           inputFileName_dates = []
               measurementType = 'met'
                         units = 'mm'
                    instrument = 'Texas TE525M'
                  instrumentSN = '85592-0121'
             loggedCalibration = []
            currentCalibration = []
                      comments = ''
                      Evaluate = 'P_1_1_1 = shiftMyData(clean_tv,P_1_1_1); % Time Shift Correction'
                        minMax = [0,20]
                        zeroPt = [-9999]
[End]

% Water parameters

[Trace]
                  variableName = 'COND_WATER_1_1_1'
                         title = 'conductivity of water'
                 inputFileName = {'MET_WaterCond_Avg'}
           inputFileName_dates = []
               measurementType = 'met'
                         units = 'microS/cm'
                    instrument = 'Eureka Manta+ 20 base'
                  instrumentSN = '05214784'
             loggedCalibration = []
            currentCalibration = []
                      comments = ''
                      Evaluate = 'COND_WATER_1_1_1 = run_std_dev(COND_WATER_1_1_1,clean_tv,wlen,thres);'
                        minMax = [0,70000]
                        zeroPt = [-9999]
[End]

[Trace]
                  variableName = 'DO_1_1_1'
                         title = 'dissolved oxygen'
                 inputFileName = {'MET_WaterDO_Avg'}
           inputFileName_dates = []
               measurementType = 'met'
                         units = 'mg/l'
                    instrument = 'Eureka Manta+ 20 base'
                  instrumentSN = '05214784'
             loggedCalibration = []
            currentCalibration = []
                      comments = ''
                        minMax = [0,70000] % Check range
                        zeroPt = [-9999]
[End]

[Trace]
                  variableName = 'DOperc_1_1_1'
                         title = 'dissolved oxygen ratio'
                 inputFileName = {'MET_WaterDO_perc_Avg'}
           inputFileName_dates = []
               measurementType = 'met'
                         units = '% saturation'
                    instrument = 'Eureka Manta+ 20 base'
                  instrumentSN = '05214784'
             loggedCalibration = []
            currentCalibration = []
                      comments = ''
                        minMax = [0,70000] % Check range
                        zeroPt = [-9999]
[End]

[Trace]
                  variableName = 'WTD_1_1_1'
                         title = 'water table height'
                 inputFileName = {'MET_WaterLevel_Avg'}
           inputFileName_dates = []
               measurementType = 'met'
                         units = 'm'
                    instrument = 'Eureka Manta+ 20 base'
                  instrumentSN = '05214784'
             loggedCalibration = []
            currentCalibration = []
                      comments = 'Calibration set WTD relative to local surface.'
                      Evaluate = 'WTD_1_1_1 = run_std_dev(WTD_1_1_1,clean_tv,wlen,thres);'
                        minMax = [-2 2]
                        zeroPt = [-9999]
[End]


[Trace]
                  variableName = 'ORP_1_1_1'
                         title = 'oxygen reduction potential'
                 inputFileName = {'MET_WaterORP_Avg'}
           inputFileName_dates = []
               measurementType = 'met'
                         units = 'mV'
                    instrument = 'Eureka Manta+ 20 base'
                  instrumentSN = '05214784'
             loggedCalibration = []
            currentCalibration = []
                      comments = ''
                      Evaluate = 'ORP_1_1_1 = run_std_dev(ORP_1_1_1,clean_tv,wlen,thres);'
                        minMax = [-500,500] % check range
                        zeroPt = [-9999]
[End]

[Trace]
                  variableName = 'pH_1_1_1'
                         title = 'water pH'
                 inputFileName = {'MET_WaterpH_Avg'}
           inputFileName_dates = []
               measurementType = 'met'
                         units = 'unitless'
                    instrument = 'Eureka Manta+ 20 base'
                  instrumentSN = '05214784'
             loggedCalibration = []
            currentCalibration = []
                      comments = ''
                      	Evaluate = 'pH_1_1_1 = run_std_dev(pH_1_1_1,clean_tv,wlen,thres);'
                        minMax = [2, 14.5]
                        zeroPt = [-9999]
[End]

[Trace]
                  variableName = 'TW_1_1_1'
                         title = 'water temperature'
                 inputFileName = {'MET_WaterT_Avg'}
           inputFileName_dates = []
               measurementType = 'met'
                         units = '°C'
                    instrument = 'Eureka Manta+ 20 base'
                  instrumentSN = '05214784'
             loggedCalibration = []
            currentCalibration = []
                      comments = ''
                      Evaluate = 'TW_1_1_1 = run_std_dev(TW_1_1_1,clean_tv,wlen,thres);'
                        minMax = [5, 40]
                        zeroPt = [-9999]
[End]


% Wind speed and direction
[Trace]
                  variableName = 'WS_1_1_1'
                         title = 'wind speed by RM Young 05103'
                 inputFileName = {'WS_1_1_1'}
           inputFileName_dates = []
               measurementType = 'flux'
                         units = 'm/s'
                    instrument = 'RM Young 05103'
                  instrumentSN = '182462'
             loggedCalibration = []
            currentCalibration = []
                      comments = ''
                      %Do not shift this trace. Comes from Flux vars.
                      %Evaluate = 'WS_1_1_1 = shiftMyData(clean_tv,WS_1_1_1); % Time Shift Correction'
                        minMax = [-40,40]
                        zeroPt = [-9999]
[End]

[Trace]
                  variableName = 'WD_1_1_1'
                         title = 'wind direction by RM Young 05103'
                 inputFileName = {'WD_1_1_1'}
           inputFileName_dates = []
               measurementType = 'flux'
                         units = 'm/s'
                    instrument = 'RM Young 05103'
                  instrumentSN = '182462'
             loggedCalibration = []
            currentCalibration = []
                      comments = ''
                      %Do not shift this trace. Comes from Flux vars.
                      %Evaluate = 'WD_1_1_1 = shiftMyData(clean_tv,WD_1_1_1); % Time Shift Correction'
                        minMax = [0,360]
                        zeroPt = [-9999]
[End]

[Trace]
                  variableName = 'badWD'
                         title = 'Remove bad wind directions from fluxes'
                 inputFileName = {'WD_1_1_1'}
           inputFileName_dates = []
               measurementType = 'flux'
                         units = 'm/s'
                    instrument = 'RM Young 05103'
                  instrumentSN = '182462'
             loggedCalibration = []
            currentCalibration = []
                      comments = 'Find index of all points outside of the target (good) wind directions.'                      
                      Evaluate = 'badZone1 = [0, 30]; badZone2 = [330, 360];
                                  badWD( badWD >= badZone1(1) & badWD <= badZone1(2)) = NaN; 
                                  badWD( badWD >= badZone2(1) & badWD <= badZone2(2)) = NaN;'
                        minMax = [0,360]
                        zeroPt = [-9999]
               dependent       = 'tag_EC_fluxes'
[End]



%------------------------------------------------------------------------------------
% Call #include ini files
%------------------------------------------------------------------------------------
%--> Must be at end of .ini file
#include EddyPro_Common_FirstStage_include.ini
#include EddyPro_LI7200_FirstStage_include.ini
#include EddyPro_LI7700_FirstStage_include.ini
#include RAD_FirstStage_include.ini
#include ECCC_FirstStage_include.ini